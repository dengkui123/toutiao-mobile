(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-248445f5"],{"16f2":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"search-container"},[r("form",{staticClass:"search-form",attrs:{action:"/"}},[r("van-search",{attrs:{"show-action":"",background:"#3296fa",placeholder:"请输入搜索关键词"},on:{search:e.onSearch,cancel:function(t){return e.$router.back()},focus:function(t){e.isResultShow=!1}},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}})],1),e.isResultShow?r("search-result",{attrs:{"search-text":e.searchText}}):e.searchText?r("search-suggestion",{attrs:{"search-text":e.searchText},on:{search:e.onSearch}}):r("search-history",{attrs:{"search-histories":e.searchHistories},on:{search:e.onSearch,"update-histories":function(t){e.searchHistories=t}}})],1)},s=[],a=r("1da1"),c=r("5530"),i=(r("96cf"),r("c975"),r("a434"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"search-history"},[r("van-cell",{attrs:{title:"搜索历史"}},[e.isDeleteShow?r("div",[r("span",{on:{click:function(t){return e.$emit("update-histories",[])}}},[e._v("全部删除")]),e._v("    "),r("span",{on:{click:function(t){e.isDeleteShow=!1}}},[e._v("完成")])]):r("van-icon",{attrs:{name:"delete"},on:{click:function(t){e.isDeleteShow=!0}}})],1),e._l(e.searchHistories,(function(t,n){return r("van-cell",{key:n,attrs:{title:t},on:{click:function(r){return e.deleteHistory(t,n)}}},[r("van-icon",{directives:[{name:"show",rawName:"v-show",value:e.isDeleteShow,expression:"isDeleteShow"}],attrs:{name:"close"}})],1)}))],2)}),o=[],u={name:"SearchHistory",components:{},props:{searchHistories:{type:Array,required:!0}},data:function(){return{isDeleteShow:!1}},watch:{},computed:{},methods:{deleteHistory:function(e,t){this.isDeleteShow?this.searchHistories.splice(t,1):this.$emit("search",e)}},created:function(){},mounted:function(){}},h=u,l=r("2877"),f=Object(l["a"])(h,i,o,!1,null,"664c4379",null),d=f.exports,p=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"search-suggestion"},e._l(e.suggestionLists,(function(t,n){return r("van-cell",{key:n,attrs:{icon:"search"},on:{click:function(r){return e.$emit("search",t)}}},[r("span",{attrs:{slot:"title"},domProps:{innerHTML:e._s(e.highLight(t))},slot:"title"})])})),1)},g=[],m=(r("4d63"),r("ac1f"),r("25f0"),r("5319"),r("b775")),v=function(e){return Object(m["a"])({method:"GET",url:"/app/v1_0/suggestion",params:{q:e}})},x=function(e){return Object(m["a"])({method:"GET",url:"/app/v1_0/search",params:e})},w=r("2ef0"),S={name:"SearchSuggestion",components:{},props:{searchText:{type:String,required:!0}},data:function(){return{suggestionLists:[]}},watch:{searchText:{handler:Object(w["debounce"])((function(e){this.loadSearchSuggestion(e)}),200),immediate:!0}},computed:{},methods:{loadSearchSuggestion:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var n,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,v(e);case 3:n=r.sent,s=n.data,t.suggestionLists=s.data.options,r.next=11;break;case 8:r.prev=8,r.t0=r["catch"](0),t.$toast("数据获取失败，请稍后重试");case 11:case"end":return r.stop()}}),r,null,[[0,8]])})))()},highLight:function(e){var t=new RegExp(this.searchText,"gi");return e.replace(t,'<span class="active">'.concat(this.searchText,"</span>"))}},created:function(){},mounted:function(){}},b=S,y=(r("54f7"),Object(l["a"])(b,p,g,!1,null,"6062f000",null)),k=y.exports,R=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"search-result"},[r("van-list",{attrs:{finished:e.finished,"finished-text":"没有更多了",error:e.error,"error-text":"加载失败，请点击重试"},on:{"update:error":function(t){e.error=t},load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.list,(function(e,t){return r("van-cell",{key:t,attrs:{title:e.title}})})),1)],1)},O=[],_=r("2909"),H={name:"SearchResult",components:{},props:{searchText:{type:String,required:!0}},data:function(){return{list:[],loading:!1,finished:!1,page:1,perPage:20,error:!1}},watch:{},computed:{},methods:{onLoad:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var r,n,s,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,x({page:e.page,per_page:e.perPage,q:e.searchText});case 3:n=t.sent,s=n.data,console.log(s),a=s.data.results,(r=e.list).push.apply(r,Object(_["a"])(a)),e.loading=!1,a.length?e.page++:e.finished=!0,t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](0),e.error=!0,e.loading=!1;case 16:case"end":return t.stop()}}),t,null,[[0,12]])})))()}},created:function(){},mounted:function(){}},T=H,E=Object(l["a"])(T,R,O,!1,null,"62eac37b",null),j=E.exports,$=r("5d2d"),D=r("2f62"),L={name:"SearchIndex",components:{SearchHistory:d,SearchSuggestion:k,SearchResult:j},props:{},data:function(){return{searchText:"",isResultShow:!1,searchHistories:[]}},watch:{searchHistories:function(){Object($["b"])("search-histories",this.searchHistories)}},computed:Object(c["a"])({},Object(D["b"])(["user"])),methods:{onSearch:function(e){this.searchText=e;var t=this.searchHistories.indexOf(e);-1!==t&&this.searchHistories.splice(t,1),this.searchHistories.unshift(e),this.isResultShow=!0},loadSearchHistories:function(){return Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()}},created:function(){this.searchHistories=Object($["a"])("search-histories")||[]},mounted:function(){}},A=L,q=(r("de9f"),Object(l["a"])(A,n,s,!1,null,"0105c834",null));t["default"]=q.exports},"25f0":function(e,t,r){"use strict";var n=r("6eeb"),s=r("825a"),a=r("d039"),c=r("ad6d"),i="toString",o=RegExp.prototype,u=o[i],h=a((function(){return"/a/b"!=u.call({source:"a",flags:"b"})})),l=u.name!=i;(h||l)&&n(RegExp.prototype,i,(function(){var e=s(this),t=String(e.source),r=e.flags,n=String(void 0===r&&e instanceof RegExp&&!("flags"in o)?c.call(e):r);return"/"+t+"/"+n}),{unsafe:!0})},"3d22":function(e,t,r){},"4d63":function(e,t,r){var n=r("83ab"),s=r("da84"),a=r("94ca"),c=r("7156"),i=r("9112"),o=r("9bf2").f,u=r("241c").f,h=r("44e7"),l=r("ad6d"),f=r("9f7f"),d=r("6eeb"),p=r("d039"),g=r("5135"),m=r("69f3").enforce,v=r("2626"),x=r("b622"),w=r("fce3"),S=r("107c"),b=x("match"),y=s.RegExp,k=y.prototype,R=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,O=/a/g,_=/a/g,H=new y(O)!==O,T=f.UNSUPPORTED_Y,E=n&&(!H||T||w||S||p((function(){return _[b]=!1,y(O)!=O||y(_)==_||"/a/i"!=y(O,"i")}))),j=function(e){for(var t,r=e.length,n=0,s="",a=!1;n<=r;n++)t=e.charAt(n),"\\"!==t?a||"."!==t?("["===t?a=!0:"]"===t&&(a=!1),s+=t):s+="[\\s\\S]":s+=t+e.charAt(++n);return s},$=function(e){for(var t,r=e.length,n=0,s="",a=[],c={},i=!1,o=!1,u=0,h="";n<=r;n++){if(t=e.charAt(n),"\\"===t)t+=e.charAt(++n);else if("]"===t)i=!1;else if(!i)switch(!0){case"["===t:i=!0;break;case"("===t:R.test(e.slice(n+1))&&(n+=2,o=!0),s+=t,u++;continue;case">"===t&&o:if(""===h||g(c,h))throw new SyntaxError("Invalid capture group name");c[h]=!0,a.push([h,u]),o=!1,h="";continue}o?h+=t:s+=t}return[s,a]};if(a("RegExp",E)){for(var D=function(e,t){var r,n,s,a,o,u,f=this instanceof D,d=h(e),p=void 0===t,g=[],v=e;if(!f&&d&&p&&e.constructor===D)return e;if((d||e instanceof D)&&(e=e.source,p&&(t="flags"in v?v.flags:l.call(v))),e=void 0===e?"":String(e),t=void 0===t?"":String(t),v=e,w&&"dotAll"in O&&(n=!!t&&t.indexOf("s")>-1,n&&(t=t.replace(/s/g,""))),r=t,T&&"sticky"in O&&(s=!!t&&t.indexOf("y")>-1,s&&(t=t.replace(/y/g,""))),S&&(a=$(e),e=a[0],g=a[1]),o=c(y(e,t),f?this:k,D),(n||s||g.length)&&(u=m(o),n&&(u.dotAll=!0,u.raw=D(j(e),r)),s&&(u.sticky=!0),g.length&&(u.groups=g)),e!==v)try{i(o,"source",""===v?"(?:)":v)}catch(x){}return o},L=function(e){e in D||o(D,e,{configurable:!0,get:function(){return y[e]},set:function(t){y[e]=t}})},A=u(y),q=0;A.length>q;)L(A[q++]);k.constructor=D,D.prototype=k,d(s,"RegExp",D)}v("RegExp")},"54f7":function(e,t,r){"use strict";r("3d22")},de9f:function(e,t,r){"use strict";r("fa17")},fa17:function(e,t,r){}}]);
//# sourceMappingURL=chunk-248445f5.a28ceccb.js.map